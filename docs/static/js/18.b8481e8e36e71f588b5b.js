webpackJsonp([18],{YJLh:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=e("vLgD"),o=function(t){return Object(l.a)({url:"api/SERVICE-AIP/lamp/queryLampPage",method:"post",data:t})},n=function(){return Object(l.a)({url:"api/SERVICE-AIP/project/queryList",method:"post",data:{}})},r=function(t){return Object(l.a)({url:"api/SERVICE-AIP/road/queryList",method:"post",data:{projectId:t}})},i=function(t){return Object(l.a)({url:"api/SERVICE-AIP/lampRunData/queryLampHisData",method:"post",data:t})},s=function(t){return Object(l.a)({url:"api/SERVICE-AIP/lampRunDataSolar/queryLampHisDataSolar",method:"post",data:t})},p=function(t){return Object(l.a)({url:"api/SERVICE-AIP/lampRunData/queryLampHisRate",method:"post",data:t})},c=function(t){return Object(l.a)({url:"api/SERVICE-AIP/centralizedControl/getcentralizedConHisInfo",method:"post",data:t})},u=function(t,a){return Object(l.a)({url:"api/SERVICE-AIP/centralizedControl/queryPage",method:"post",data:{pageNum:t,pageSize:a}})},d=function(t){return Object(l.a)({url:"api/SERVICE-AIP/centralizedControl/getLoopHisInfo",method:"post",data:t})},h=e("0xDb"),m={data:function(){return{innerFlag:"",flag:"1",lampTypeFlag:"",total:0,pageSize:10,currentPage:1,selectedRowId:"",tableData:[],tableData2:[],tableData3:[],tableData4:[],tableData5:[],loopInfoList:[],loopNum:0,loopArray:[{name:"回路1"},{name:"回路2"},{name:"回路3"},{name:"回路4"},{name:"回路5"},{name:"回路6"},{name:"回路7"},{name:"回路8"},{name:"回路9"}],date:[],showDialog:!1,searchInfo:{projectId:"",roadId:""},options:{project:[],road:[]},lightingRateOption:{tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["总灯数","亮灯数","亮灯率"]},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:[{type:"category",data:[]}],yAxis:[{type:"value",name:"总灯数",position:"right",min:0,max:20,minInterval:1,axisLabel:{formatter:function(t){return t+"盏"}}},{type:"value",name:"亮灯数",position:"right",offset:80,min:0,max:20,minInterval:1,axisLabel:{formatter:function(t){return t+"盏"}}},{type:"value",name:"亮灯率",position:"left",min:0,max:1,axisLabel:{formatter:function(t){return 100*t+"%"}}}],series:[{name:"总灯数",type:"bar",barWidth:40,itemStyle:{normal:{color:"#fff",borderColor:"#000"}},barGap:"-100%",data:[]},{name:"亮灯数",type:"bar",yAxisIndex:1,itemStyle:{normal:{color:"#000000"}},barWidth:40,data:[]},{name:"亮灯率",type:"line",yAxisIndex:2,smooth:!0,data:[]}]},lightingDataOption:{tooltip:{trigger:"axis"},legend:{data:["电流","电压"]},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:[]}],yAxis:[{type:"value",name:"电流",axisLabel:{formatter:function(t){return t+"A"}}},{type:"value",name:"电压",min:0,max:300,axisLabel:{formatter:"{value} V"}}],series:[{name:"电流",type:"line",smooth:!0,data:[]},{name:"电压",type:"line",yAxisIndex:1,smooth:!0,data:[]}]},lightingDataOptionSolar:{tooltip:{trigger:"axis"},legend:{data:["蓄电池电压","负载电流","负载电压","光电池电流","光电池电压"]},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:[]}],yAxis:[{type:"value",name:"电流",axisLabel:{formatter:function(t){return t+"A"}}},{type:"value",name:"电压",min:0,max:100,axisLabel:{formatter:"{value} V"}}],series:[{name:"蓄电池电压",yAxisIndex:1,type:"line",smooth:!0,data:[]},{name:"负载电流",type:"line",smooth:!0,data:[]},{name:"负载电压",yAxisIndex:1,type:"line",smooth:!0,data:[]},{name:"光电池电流",type:"line",smooth:!0,data:[]},{name:"光电池电压",yAxisIndex:1,type:"line",smooth:!0,data:[]}]}}},components:{echart:e("5wQ8").a},mounted:function(){this.getTableData(),this.queryProjectOptions(),this.queryRoadOptions()},methods:{getTableData:function(){var t=this,a={pageNum:this.currentPage,pageSize:this.pageSize,projectId:this.searchInfo.projectId,roadId:this.searchInfo.roadId};if("1"===this.flag)o(a).then(function(a){t.tableData=a.records,t.total=a.total});else if("2"===this.flag){var e={projectId:this.searchInfo.projectId,roadId:this.searchInfo.roadId,startTime:null===this.date?"":this.date[0],endTime:null===this.date?"":this.date[1]};p(e).then(function(a){t.tableData2=a,t.lightingRateOption.series.forEach(function(t){t.data=[]}),t.lightingRateOption.xAxis[0].data=[],a.map(function(a){t.lightingRateOption.series[0].data.push(a.totalLampNum),t.lightingRateOption.series[1].data.push(a.onLampNum),t.lightingRateOption.series[2].data.push(a.rate),t.lightingRateOption.xAxis[0].data.push(Object(h.parseTime)(a.updateTime,"{y}-{m}-{d} {h}:{i}:{s}"))}),t.chartReload()})}else u(this.currentPage,this.pageSize).then(function(a){t.tableData3=a.records,t.total=a.total})},queryProjectOptions:function(){var t=this;n().then(function(a){t.options.project=a})},queryRoadOptions:function(){var t=this;r(this.searchInfo.projectId).then(function(a){t.options.road=a})},selectProject:function(){this.queryRoadOptions(),this.searchInfo.roadId="",this.getTableData()},selectRoad:function(){this.getTableData()},lampType:function(t){if(t.lampType)return"0"===t.lampType?"市电灯":"太阳能灯"},lightingRate:function(t){return null!=t.rate?100*t.rate+"%":"暂无数据"},updateTime:function(t){return null===t.lampRunData?"暂无数据":Object(h.parseTime)(t.updateTime)},handleSelectionChange:function(t){this.multipleSelection=t},current_change:function(t){this.currentPage=t,this.getTableData()},selectDate:function(){"1"===this.innerFlag?this.lightingData(!1,this.lampTypeFlag):this.loopElectricity()},lightingData:function(t,a){var e=this;t&&(this.selectedRowId=t);var l={lampId:this.selectedRowId,startTime:null===this.date?"":this.date[0],endTime:null===this.date?"":this.date[1]};this.lampTypeFlag=a,"0"===a?i(l).then(function(t){e.lightingDataOption.series[0].data=[],e.lightingDataOption.series[1].data=[],e.lightingDataOption.xAxis[0].data=[],t.map(function(t){e.lightingDataOption.series[0].data.push(t.electriccurrent),e.lightingDataOption.series[1].data.push(t.voltage),e.lightingDataOption.xAxis[0].data.push(Object(h.parseTime)(t.updateTime,"{y}-{m}-{d} {h}:{i}:{s}"))}),e.chartReload()}):"1"===a&&s(l).then(function(t){e.lightingDataOptionSolar.series[0].data=[],e.lightingDataOptionSolar.series[1].data=[],e.lightingDataOptionSolar.series[2].data=[],e.lightingDataOptionSolar.series[3].data=[],e.lightingDataOptionSolar.series[4].data=[],e.lightingDataOptionSolar.xAxis[0].data=[],t.map(function(t){e.lightingDataOptionSolar.series[0].data.push(t.accumulatorVoltage),e.lightingDataOptionSolar.series[1].data.push(t.loadCurrent),e.lightingDataOptionSolar.series[2].data.push(t.loadColtage),e.lightingDataOptionSolar.series[3].data.push(t.photocellCurrent),e.lightingDataOptionSolar.series[4].data.push(t.photocellVoltage),e.lightingDataOptionSolar.xAxis[0].data.push(Object(h.parseTime)(t.updateTime,"{y}-{m}-{d} {h}:{i}:{s}"))}),e.chartReload()}),this.showDialog=!0,this.innerFlag="1"},loopElectricity:function(t,a){var e=this;t&&(this.selectedRowId=t,this.innerFlag=a);var l={centralizedControlId:this.selectedRowId,startTime:null===this.date?"":this.date[0],endTime:null===this.date?"":this.date[1]};d(l).then(function(t){e.loopInfoList=t.loopInfoList}),this.showDialog=!0},threePhaseData:function(t){var a=this;t&&(this.selectedRowId=t);var e={centralizedControlId:this.selectedRowId,startTime:null===this.date?"":this.date[0],endTime:null===this.date?"":this.date[1]};c(e).then(function(t){a.tableData5=t}),this.showDialog=!0,this.innerFlag="3"},chartReload:function(){this.$refs.myChart.reload()},closeDialog:function(){this.date=[]}}},g={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-row",{attrs:{type:"flex",align:"middle"}},[e("el-col",{attrs:{span:6}},[e("el-radio-group",{on:{change:t.getTableData},model:{value:t.flag,callback:function(a){t.flag=a},expression:"flag"}},[e("el-radio-button",{attrs:{label:"1"}},[t._v("灯具数据")]),t._v(" "),e("el-radio-button",{attrs:{label:"2"}},[t._v("亮灯率")]),t._v(" "),e("el-radio-button",{attrs:{label:"3"}},[t._v("集控器数据")])],1)],1),t._v(" "),e("el-col",{attrs:{span:1}},[e("div",[t._v("项目")])]),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-select",{model:{value:t.searchInfo.projectId,callback:function(a){t.$set(t.searchInfo,"projectId",a)},expression:"searchInfo.projectId"}},t._l(t.options.project,function(a){return e("el-option",{key:a.rowId,attrs:{label:a.projectName,value:a.rowId},on:{change:t.selectProject}})}),1)],1),t._v(" "),e("el-col",{attrs:{span:1}},[e("div",[t._v("路段")])]),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-select",{model:{value:t.searchInfo.roadId,callback:function(a){t.$set(t.searchInfo,"roadId",a)},expression:"searchInfo.roadId"}},t._l(t.options.road,function(a){return e("el-option",{key:a.rowId,attrs:{label:a.roadName,value:a.rowId},on:{change:t.selectRoad}})}),1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-button",{on:{click:function(a){return t.exportExcel()}}},[t._v("导出Excel")])],1),t._v(" "),e("el-col",{attrs:{span:8}},["2"===t.flag?e("div",[e("span",{staticClass:"demonstration"},[t._v("选择日期")]),t._v(" "),e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp"},on:{change:t.getTableData},model:{value:t.date,callback:function(a){t.date=a},expression:"date"}})],1):t._e()])],1),t._v(" "),"1"===t.flag?e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"lampType",label:"灯具类型",formatter:t.lampType}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"lampName",label:"灯具名称"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"lampConAddress",label:"灯控器地址"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{label:"灯具数据"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[e("a",{staticStyle:{color:"blue"},on:{click:function(e){return t.lightingData(a.row.rowId,a.row.lampType)}}},[t._v("查看数据")])])]}}],null,!1,1659193027)})],1):t._e(),t._v(" "),"2"===t.flag?e("div",{staticStyle:{height:"450px","margin-top":"70px"}},[e("echart",{ref:"myChart",attrs:{chartData:t.lightingRateOption,className:"lightingRateChart"}})],1):t._e(),t._v(" "),"3"===t.flag?e("el-table",{ref:"multipleTable3",staticStyle:{width:"100%"},attrs:{data:t.tableData3,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"typeName",label:"网关类型"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"name",label:"网关名称"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"address",label:"网关地址"}}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"",label:"回路开闭数据"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[e("a",{staticStyle:{color:"blue"},on:{click:function(e){return t.loopElectricity(a.row.rowId,"2")}}},[t._v("查看数据")])])]}}],null,!1,1595575788)}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"",label:"三相电数据"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[e("a",{staticStyle:{color:"blue"},on:{click:function(e){return t.threePhaseData(a.row.rowId)}}},[t._v("查看数据")])])]}}],null,!1,60812856)}),t._v(" "),e("el-table-column",{key:Math.random(),attrs:{prop:"",label:"回路电流数据"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[e("a",{staticStyle:{color:"blue"},on:{click:function(e){return t.loopElectricity(a.row.rowId,"4")}}},[t._v("查看数据")])])]}}],null,!1,1529392042)})],1):t._e(),t._v(" "),"2"!=t.flag?e("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.current_change}})],1):t._e(),t._v(" "),e("el-dialog",{staticClass:"dialog-common-sys",attrs:{visible:t.showDialog,"modal-append-to-body":!1,width:"70%"},on:{"update:visible":function(a){t.showDialog=a},close:function(a){return t.closeDialog()}}},[e("div",[e("span",{staticClass:"demonstration"},[t._v("选择日期")]),t._v(" "),e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp"},on:{change:t.selectDate},model:{value:t.date,callback:function(a){t.date=a},expression:"date"}})],1),t._v(" "),"1"===t.innerFlag?e("div",{staticStyle:{height:"450px","margin-top":"70px"}},["0"===t.lampTypeFlag?e("echart",{ref:"myChart",attrs:{chartData:t.lightingDataOption,className:"lightingDataChart"}}):t._e(),t._v(" "),"1"===t.lampTypeFlag?e("echart",{ref:"myChart",attrs:{chartData:t.lightingDataOptionSolar,className:"lightingDataChart"}}):t._e()],1):t._e(),t._v(" "),"2"===t.innerFlag?e("el-table",{ref:"multipleTable",attrs:{data:t.loopInfoList,"tooltip-effect":"dark",height:"500"}},[t._l(t.loopArray.slice(0,this.loopNum-1),function(a,l){return e("el-table-column",{key:l,attrs:{label:a.name},scopedSlots:t._u([{key:"default",fn:function(a){return null!=a.row?[t._v("\n          "+t._s("1"===a.row.devicestatus?"断开":"闭合")+"\n        ")]:void 0}}],null,!0)})}),t._v(" "),e("el-table-column",{attrs:{prop:"updateTime",label:"上报时间",formatter:t.updateTime}})],2):t._e(),t._v(" "),"4"===t.innerFlag?e("el-table",{ref:"multipleTable",attrs:{data:t.loopInfoList,"tooltip-effect":"dark",height:"500"}},[t._l(t.loopArray.slice(0,this.loopNum-1),function(a,l){return e("el-table-column",{key:l,attrs:{label:a.name},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n          "+t._s(a.row[l+1].loopElectriccurrent)+"\n        ")]}}],null,!0)})}),t._v(" "),e("el-table-column",{attrs:{prop:"updateTime",label:"上报时间",formatter:t.updateTime}})],2):t._e(),t._v(" "),"3"===t.innerFlag?e("el-table",{ref:"multipleTable",attrs:{data:t.tableData5,"tooltip-effect":"dark",height:"500"}},[e("el-table-column",{attrs:{prop:"aapparentwork",label:"A相视在功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bapparentwork",label:"B相视在功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"capparentwork",label:"C相视在功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"happarentwork",label:"合相视在功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"aavailablework",label:"A相有功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bavailablework",label:"B相有功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"cavailablework",label:"C相有功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"havailablework",label:"合相有功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"avoltage",label:"A相电压(V)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bvoltage",label:"B相电压(V)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"cvoltage",label:"C相电压(V)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"acurrent",label:"A相电流(A)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bcurrent",label:"B相电流(A)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ccurrent",label:"C相电流(A)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"hcurrent",label:"合相电流(A)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"auselesswork",label:"A相无功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"buselesswork",label:"B相无功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"cuselesswork",label:"C相无功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"huselesswork",label:"合相无功功率(W)"}}),t._v(" "),e("el-table-column",{attrs:{prop:"updateTime",label:"上报时间",formatter:t.updateTime}})],1):t._e(),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.showDialog=!1}}},[t._v("关 闭")])],1)],1)],1)},staticRenderFns:[]},b=e("VU/8")(m,g,!1,null,null,null);a.default=b.exports}});