webpackJsonp([42],{"4VAF":function(e,t,o){"use strict";(function(e){var s=o("woOf"),r=o.n(s),a=o("0yOY"),i=o("0xDb"),l=o("eemd"),n=o("mA0B"),u=o("hbRw"),c=o("pDcy"),d=(o("onxG"),o("kTXO"));t.a={data:function(){var e=this,t=function(t,o,s){var r="";r="newPwd"===t.field?e.modifyPwd.confirmPwd:e.modifyPwd.newPwd,""===o?s(new Error("请再次输入密码")):o!==r&&""!==r?s(new Error("两次输入密码不一致!")):s()};return{orgName:"",orgData:[],activeName:"first",prjIds:[],prjData:[],multipleSelection:[],multipleSelectionAllIds:[],searchInput:"",tipDialog:!1,tipDialogTxt:"",dialogTitle:"新增",roleData:[],userId:0,roleIds:[],roleProps:{key:"rowId",label:"roleName"},userName:"",tableList:[],recordCount:0,pageSize:10,pageAt:1,showDialog:!1,showModifyPwdDialog:!1,showSetDialog:!1,company:[],orgs:[],militaryranks:[],posts:[],userTypes:[],user:{rowId:"",userName:"",password:"",orgId:"",orgName:"",sex:"M",userType:"1",phone:"",statusFlag:""},modifyPwd:{newPwd:"",confirmPwd:""},formLabelWidth:"80px",rules:{userCode:[{required:!0,message:"请输入用户账号",trigger:"blur"},{min:2,max:12,message:"长度在 2 到 12 个字符",trigger:"blur"}],userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:8,message:"长度在 2 到 8 个字符",trigger:"blur"}],orgId:[{required:!0,message:"请选择公司",trigger:"change"}],sex:[{required:!0,message:"请选择性别",trigger:"change"}],userLevel:[{required:!0,message:"请输入用户等级",trigger:"change"}],userType:[{required:!0,type:"string",message:"请选择用户类别",trigger:"change"}],phone:[{required:!0,message:"请输入联系方式",trigger:"blur"},{validator:function(e,t,o){if(!t)return o(new Error("请输入合法的手机号码"));setTimeout(function(){/^1[34578]\d{9}$/.test(t)?o():o(new Error("请输入合法的手机号码"))},100)},trigger:"blur"}],introduction:[{required:!0,message:"请输入个人简介",trigger:"blur"}]},modifyPwdRules:{newPwd:{required:!0,trigger:["blur","change"],validator:t},confirmPwd:{required:!0,trigger:["blur","change"],validator:t}},filterMethod:function(e,t){return t.roleName.indexOf(e)>-1}}},filters:{formatDate:function(e){var t=new Date(e);return Object(i.parseTime)(t,"{y}-{m}-{d}")}},methods:{insertTemplate:function(e){var t=this;this.orgData.map(function(o){o.rowId==e&&(t.user.orgId=o.rowId,t.user.orgName=o.orgName)})},hasPerms:function(e){return Object(d.a)(e)&!this.disabled},handleClick:function(e,t){console.log(e,t)},getPrjSelect:function(){var e=this;n.a.queryByInfo({userId:this.user.rowId}).then(function(t){e.prjIds=[],t.map(function(t){e.prjIds.push(t.projectId)}),e.getAllProject()},function(e){},!1)},getAllProject:function(){var e=this;l.a.queryList().then(function(t){e.prjData=t},function(e){},!1)},handleSelectionChange:function(e){this.multipleSelection=e},getUserList:function(){var e=this,t={pageNum:this.pageAt,pageSize:this.pageSize,commonCondition:this.userName};a.a.getUserList(t).then(function(t){e.recordCount=t.total,e.tableList=t.records||[],setTimeout(function(){e.$utils.setSelectRow(e.multipleSelectionAllIds,e.$refs.singleTable,e.tableList)},200)}).catch(function(e){console.log("获取数据出现异常")})},getCompany:function(){var e=this;c.a.getAllOrgList({}).then(function(t){e.orgData=t})},getDepartment:function(){var t=this;""==t.user.companyName||""==t.user.companyId?t.$message.info("请先选择单位！"):e.post(api.department,{},{params:{nullable:"COMPANY_ID="+t.user.companyId}},function(e){var o=t.toHump(e.body);t.orgs=o},function(e){console.info(e)},!1)},getOrgs:function(){e.post(api.getOrg,{},{},function(e){},function(e){},!1)},getPosts:function(){var t=this;e.post(api.getPost,{},{},function(e){t.posts=e.body},function(e){},!1)},getMilitaryranks:function(){var t=this;e.post(api.getMilitaryrank,{},{},function(e){t.militaryranks=e.body},function(e){},!1)},getUserTypes:function(){var t=this;e.post(api.getUserType,{},{},function(e){t.userTypes=t.toHump(e.body)},function(e){},!1)},doRefresh:function(){this.pageAt=1,this.getUserList()},resetForm:function(e){this.$refs[e].resetFields()},doAdd:function(){this.showDialog=!0,this.dialogTitle="新增",this.user={userName:"",password:"",orgId:"",orgName:"",sex:"M",userType:"",phone:"",statusFlag:"1"}},saveOrUpdate:function(e,t){var o=this;this.$refs[t].validate(function(e){if(!e)return!1;a.a.addOrUpdate(o.user).then(function(e){o.showDialog=!1,o.$message({type:"success",message:"新增"==o.dialogTitle?"新增成功!":"修改成功!"}),o.getUserList()},function(e){o.showDialog=!1,o.$message.error("数据访问失败，无法执行该操作!")},!1)})},sureDelete:function(e){var t=this;this.$confirm("确定要删除此条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.doDelete(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},doDelete:function(e){var t=this;a.a.deleteRow(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getUserList()},function(e){t.$message.error("网络异常，无法执行该操作!")},!1)},doModify:function(e){this.showDialog=!0,this.dialogTitle="修改",this.user=r()(this.user,e)},cannelUpdate:function(e){this.$refs[e].resetFields(),this.showDialog=!1,this.getUserList()},getHasSelect:function(){var e=this;u.a.queryByInfo({userId:this.user.rowId}).then(function(t){e.roleIds=[],t.map(function(t){e.roleIds.push(t.roleId)}),e.getAllSelect()},function(e){},!1)},getAllSelect:function(){var e=this;u.a.queryList({}).then(function(t){e.roleData=t},function(e){},!1)},setRow:function(e){this.showSetDialog=!0,this.user=r()(this.user,e),this.getHasSelect(),this.getPrjSelect()},postSet:function(){var e=this;this.showSetDialog=!1,u.a.saveByUserId(this.user.rowId,this.roleIds).then(function(t){e.$message({type:"success",message:"分配权限成功!"})},function(t){e.$message.error("网络异常，无法执行该操作!")},!1)},prjSet:function(){var e=this;this.showSetDialog=!1;var t={userId:this.user.rowId,prjIds:this.prjIds};n.a.saveByPrjId(t).then(function(t){e.$message({type:"success",message:"分配权限成功!"})},function(t){e.$message.error("网络异常，无法执行该操作!")},!1)},doModifyPwd:function(){var e=this;this.$refs.modifyPwdForm.validate(function(t){t&&e.$confirm("确定修改用户密码?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.a.modifyPwd(e.user.rowId,e.modifyPwd.confirmPwd).then(function(t){e.$message({type:"success",message:"密码修改成功!"}),e.showModifyPwdDialog=!1},function(t){e.$message.error("网络异常，无法执行该操作!")},!1)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})})},cannelSet:function(){this.showSetDialog=!1},pagePost:function(e){this.multipleSelectionAllIds=this.$utils.changePageCoreRecordData(this.multipleSelectionAllIds,this.multipleSelection,this.tableList),this.pageAt=e,this.getUserList()},pageSizePost:function(e){this.multipleSelectionAllIds=this.$utils.changePageCoreRecordData(this.multipleSelectionAllIds,this.multipleSelection,this.tableList),this.pageSize=e,this.getUserList()},toHump:function(e){var t=[];return e.forEach(function(e,o,s){var r={};for(var a in e){r[a.toLocaleLowerCase().split("_").reduce(function(e,t){return e+t[0].toUpperCase()+t.substr(1)})]=e[a]}t.push(r)}),t}},mounted:function(){this.getUserList(),this.getCompany()}}}).call(t,o("DuR2"))},E2iy:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("4VAF"),r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"app-container userManage"},[o("el-col",[o("div",{staticClass:"container"},[o("div",{staticClass:"heading"},[o("el-input",{staticClass:"search",attrs:{size:"small",placeholder:"请输入用户账号或用户名",span:4},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getUserList}},[e._v("查询")]),e._v(" "),e.hasPerms("um-xz001")?o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.doAdd}},[e._v("新增")]):e._e()],1),e._v(" "),o("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableList,border:"","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{property:"userCode",label:"用户账号"}}),e._v(" "),o("el-table-column",{attrs:{property:"userName",label:"用户名"}}),e._v(" "),o("el-table-column",{attrs:{property:"orgName",label:"所属公司"}}),e._v(" "),o("el-table-column",{attrs:{property:"sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s("M"==t.row.sex?"男":"F"==t.row.sex?"女":"未知")+"\n            ")]}}])}),e._v(" "),o("el-table-column",{attrs:{property:"phone",label:"手机号","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.phone?t.row.phone:"暂无")+"\n            ")]}}])}),e._v(" "),o("el-table-column",{attrs:{property:"createTime",label:"创建时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatDate")(t.row.createTime))+"\n            ")]}}])}),e._v(" "),o("el-table-column",{attrs:{property:"updateTime",label:"更新时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatDate")(t.row.updateTime))+"\n            ")]}}])}),e._v(" "),o("el-table-column",{attrs:{fixed:"right",width:"270",label:"操作","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPerms("um-sc001")?o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.sureDelete(t.row.rowId)}}},[e._v("删除")]):e._e(),e._v(" "),e.hasPerms("um-xg001")?o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.doModify(t.row)}}},[e._v("修改")]):e._e(),e._v(" "),e.hasPerms("um-qx001")?o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.setRow(t.row)}}},[e._v("权限设置")]):e._e()]}}])})],1),e._v(" "),o("div",{staticClass:"pagination-wrapper"},[o("el-pagination",{attrs:{"current-page":e.pageAt,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.recordCount},on:{"current-change":e.pagePost,"size-change":e.pageSizePost}})],1),e._v(" "),o("el-dialog",{attrs:{width:"40%","append-to-body":!0,title:e.dialogTitle,visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.cannelUpdate("ruleForm")}}},[o("el-dialog",{attrs:{width:"30%",title:"修改密码",visible:e.showModifyPwdDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showModifyPwdDialog=t}}},[o("el-form",{ref:"modifyPwdForm",attrs:{model:e.modifyPwd,rules:e.modifyPwdRules}},[o("el-form-item",{attrs:{label:"新密码","label-width":e.formLabelWidth,prop:"newPwd"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium",type:"password","auto-complete":"off",placeholder:""},on:{focus:function(t){e.modifyPwd.newPwd=""}},model:{value:e.modifyPwd.newPwd,callback:function(t){e.$set(e.modifyPwd,"newPwd",t)},expression:"modifyPwd.newPwd"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"确认密码","label-width":e.formLabelWidth,prop:"confirmPwd"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium",type:"password","auto-complete":"off",placeholder:""},on:{focus:function(t){e.modifyPwd.confirmPwd=""}},model:{value:e.modifyPwd.confirmPwd,callback:function(t){e.$set(e.modifyPwd,"confirmPwd",t)},expression:"modifyPwd.confirmPwd"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.showModifyPwdDialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doModifyPwd()}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-form",{ref:"ruleForm",attrs:{model:e.user,rules:e.rules}},[o("el-form-item",{attrs:{label:"用户账号","label-width":e.formLabelWidth,prop:"userCode"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium","auto-complete":"off",placeholder:""},model:{value:e.user.userCode,callback:function(t){e.$set(e.user,"userCode",t)},expression:"user.userCode"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth,prop:"userName"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium","auto-complete":"off",placeholder:""},model:{value:e.user.userName,callback:function(t){e.$set(e.user,"userName",t)},expression:"user.userName"}})],1)],1),e._v(" "),"新增"===e.dialogTitle?o("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,prop:"password"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium",type:"password","auto-complete":"off",placeholder:""},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1)],1):"修改"===e.dialogTitle?o("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,prop:"password"}},[o("el-col",{attrs:{span:8}},[o("el-button",{attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(t){e.showModifyPwdDialog=!0}}},[e._v("修改密码")])],1)],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"联系方式","label-width":e.formLabelWidth,prop:"phone"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"medium",type:"tel","auto-complete":"off",placeholder:""},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"性别","label-width":e.formLabelWidth,prop:"sex"}},[o("el-col",{attrs:{span:8}},[o("el-radio",{staticClass:"radio",attrs:{label:"M"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[e._v("男")]),e._v(" "),o("el-radio",{staticClass:"radio",attrs:{label:"F"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[e._v("女")])],1)],1),e._v(" "),e._e(),e._v(" "),o("el-form-item",{attrs:{label:"所属公司","label-width":e.formLabelWidth,prop:"orgId"}},[o("el-select",{attrs:{placeholder:"请选择所属公司",filterable:""},on:{change:e.insertTemplate},model:{value:e.user.orgName,callback:function(t){e.$set(e.user,"orgName",t)},expression:"user.orgName"}},e._l(e.orgData,function(e){return o("el-option",{key:e.rowId,attrs:{label:e.orgName,value:e.rowId}})}),1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){return e.cannelUpdate("ruleForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveOrUpdate(e.user,"ruleForm")}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"moreSel-dialog",attrs:{width:"30%","modal-append-to-body":!1,title:"权限设置",visible:e.showSetDialog},on:{"update:visible":function(t){e.showSetDialog=t}}},[o("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"角色权限",name:"first"}},[o("el-select",{attrs:{placeholder:"请选择要给该人员分配的权限角色",multiple:""},model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},e._l(e.roleData,function(e){return o("el-option",{key:e.rowId,attrs:{label:e.roleName,value:e.rowId}})}),1),e._v(" "),o("el-button",{on:{click:e.cannelSet}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.postSet}},[e._v("确 定")])],1),e._v(" "),o("el-tab-pane",{attrs:{label:"项目权限",name:"second"}},[o("el-select",{attrs:{placeholder:"请选择要给该人员分配的权限项目",multiple:""},model:{value:e.prjIds,callback:function(t){e.prjIds=t},expression:"prjIds"}},e._l(e.prjData,function(e){return o("el-option",{key:e.rowId,attrs:{label:e.projectName,value:e.rowId}})}),1),e._v(" "),o("el-button",{on:{click:e.cannelSet}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.prjSet}},[e._v("确 定")])],1)],1)],1),e._v(" "),o("el-dialog",{staticClass:"tipDialog",attrs:{"modal-append-to-body":!1,title:"提示",visible:e.tipDialog,size:"tiny"},on:{"update:visible":function(t){e.tipDialog=t}}},[o("span",{staticClass:"el-icon-circle-check"}),e._v(" "),o("span",{staticClass:"tipDialogTxt"},[e._v(e._s(e.tipDialogTxt))]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.tipDialog=!1}}},[e._v("确 定")])],1)])],1)])],1)},staticRenderFns:[]},a=o("VU/8")(s.a,r,!1,null,null,null);t.default=a.exports},mA0B:function(e,t,o){"use strict";var s=o("vLgD");t.a={saveByPrjId:function(e){return Object(s.a)({url:"api/SERVICE-AIP/projectUserRel/saveByPrjId",method:"post",data:e})},queryByInfo:function(e){return Object(s.a)({url:"api/SERVICE-AIP/projectUserRel/queryList",method:"post",data:e})}}}});