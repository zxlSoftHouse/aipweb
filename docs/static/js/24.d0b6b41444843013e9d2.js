webpackJsonp([24],{IR2M:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n("woOf"),a=n.n(l),o=n("vLgD"),r=function(e,t){return Object(o.a)({url:"api/SERVICE-AIP/ledScreen/queryPage",method:"post",data:{pageNum:e,pageSize:t}})},i=function(e){return Object(o.a)({url:"api/SERVICE-AIP/ledScreen/deleteLEDScreen",method:"post",data:e})},s=function(e){return Object(o.a)({url:"api/SERVICE-AIP/ledScreen/update",method:"put",data:e})},c=function(e){return Object(o.a)({url:"api/SERVICE-AIP/ledScreen/queryById/"+e,method:"get",params:{}})},d=function(){return Object(o.a)({url:"api/SERVICE-AIP/lampPost/getLampPostTenderList",method:"post",data:{}})},u=function(e){return Object(o.a)({url:"api/SERVICE-AIP/lampPost/queryList",method:"post",data:{lampPostCode:e}})},p=function(e){return Object(o.a)({url:"led/command/"+e,method:"post",data:{type:"callCardService",fn:"reboot",arg1:1}})},h=function(e){return Object(o.a)({url:"led/command/"+e,method:"post",data:{type:"callCardService",fn:"screenshot",arg1:100,arg2:100}})},m={data:function(){return{flag:"",total:0,pageSize:10,currentPage:1,tableData:[],multipleSelection:[],showDialog:!1,dialogTitle:"",ledScreen:{deviceAddress:"",ipAddress:"",lampPostId:"",ledName:"",onlinestate:"",originCode:"",rowId:"",screenHeight:"",screenWidth:"",tenderId:""},rules:{},tenderOptions:[],lampPostOptions:[],formLabelWidth:"80px",loading:!1,showScreenShot:!1,screenShotSrc:""}},mounted:function(){this.getTableData(),this.getTenderOptions()},methods:{getTableData:function(){var e=this;r(this.currentPage,this.pageSize).then(function(t){e.total=t.total,e.tableData=t.records})},getTenderOptions:function(){var e=this;d().then(function(t){e.tenderOptions=t.filter(function(e){return"04"===e.deviceType})})},handleAdd:function(){this.ledScreen.rowId="",this.flag="add",this.dialogTitle="新增",this.showDialog=!0},handleEdit:function(){var e=this;this.dialogTitle="编辑",this.flag="edit",0!=this.multipleSelection.length?1===this.multipleSelection.length?c(this.multipleSelection[0].rowId).then(function(t){e.ledScreen=a()(e.ledScreen,t),e.showDialog=!0}):this.$message({type:"warning",message:"不支持多条编辑"}):this.$message({type:"warning",message:"请先选择一条记录"})},handleDelete:function(){var e=this;0!=this.multipleSelection.length?this.$confirm("确定要删除此条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(e){t.push(e.rowId)}),e.doDelete(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({type:"warning",message:"请先选择一条记录"})},doDelete:function(e){var t=this;i(e).then(function(e){e?(t.$message({type:"success",message:"删除成功"}),t.getTableData()):t.$message.error("服务器错误")})},saveOrUpdate:function(){var e=this;s(this.ledScreen).then(function(t){t.rowId?(e.showDialog=!1,e.$message({type:"success",message:"add"==e.flag?"新增成功":"修改成功"}),e.getTableData()):e.$message.error("服务器错误")})},cancelUpdate:function(){this.showDialog=!1,this.$refs.Form.resetFields()},handleSelectionChange:function(e){this.multipleSelection=e},current_change:function(e){this.currentPage=e,this.getTableData()},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,u(e).then(function(e){t.loading=!1,t.lampPostOptions=e})):this.lampPostOptions=[]},restart:function(){var e=this;0!=this.multipleSelection.length?this.$confirm("确定要重启吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(e){t.push(e.ipAddress)}),p(t).then(function(e){})}).catch(function(){e.$message({type:"info",message:"已取消"})}):this.$message({type:"warning",message:"请先选择一条记录"})},screenShot:function(){var e=this;0!=this.multipleSelection.length?1===this.multipleSelection.length?h(this.multipleSelection[0].ipAddress).then(function(t){e.screenShotSrc="data:image/png;base64,"+t.result.replace(/[\n]/g,""),e.showScreenShot=!0}):this.$message({type:"warning",message:"不支持多条截屏"}):this.$message({type:"warning",message:"请先选择一块led屏"})}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-col",[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleAdd()}}},[e._v("新增")]),e._v(" "),n("el-button",{on:{click:function(t){return e.handleEdit()}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.restart()}}},[e._v("重启")]),e._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.screenShot()}}},[e._v("截屏")])],1)],1),e._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"ledName",label:"屏幕名称"}})],1),e._v(" "),n("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.current_change}})],1),e._v(" "),n("el-dialog",{staticClass:"dialog-common-sys",attrs:{title:e.dialogTitle,visible:e.showDialog,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.cancelUpdate()}}},[n("el-row",{attrs:{type:"flex",align:"middle"}},[n("el-form",{ref:"Form",attrs:{inline:!0,model:e.ledScreen,rules:e.rules}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"屏幕名称","label-width":e.formLabelWidth,prop:"ledName"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写屏幕名称"},model:{value:e.ledScreen.ledName,callback:function(t){e.$set(e.ledScreen,"ledName",t)},expression:"ledScreen.ledName"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"厂家","label-width":e.formLabelWidth,prop:"tenderId"}},[n("el-select",{attrs:{placeholder:"请选择厂家"},model:{value:e.ledScreen.tenderId,callback:function(t){e.$set(e.ledScreen,"tenderId",t)},expression:"ledScreen.tenderId"}},e._l(e.tenderOptions,function(e){return n("el-option",{key:e.rowId,attrs:{label:e.venderName,value:e.rowId}})}),1)],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"IP地址","label-width":e.formLabelWidth,prop:"ipAddress"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写IP地址"},model:{value:e.ledScreen.ipAddress,callback:function(t){e.$set(e.ledScreen,"ipAddress",t)},expression:"ledScreen.ipAddress"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"宽(像素)","label-width":e.formLabelWidth,prop:"screenWidth"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写屏幕宽度"},model:{value:e.ledScreen.screenWidth,callback:function(t){e.$set(e.ledScreen,"screenWidth",t)},expression:"ledScreen.screenWidth"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"高(像素)","label-width":e.formLabelWidth,prop:"screenHeight"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写屏幕高度"},model:{value:e.ledScreen.screenHeight,callback:function(t){e.$set(e.ledScreen,"screenHeight",t)},expression:"ledScreen.screenHeight"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"绑定灯杆","label-width":e.formLabelWidth,prop:"lampPostId"}},[n("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入灯杆编号","remote-method":e.remoteMethod,loading:e.loading},model:{value:e.ledScreen.lampPostId,callback:function(t){e.$set(e.ledScreen,"lampPostId",t)},expression:"ledScreen.lampPostId"}},e._l(e.lampPostOptions,function(e){return n("el-option",{key:e.rowId,attrs:{label:e.lampPostCode,value:e.rowId}})}),1)],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){return e.cancelUpdate()}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveOrUpdate()}}},[e._v("确 定")])],1)],1),e._v(" "),n("el-dialog",{staticClass:"dialog-common-sys",attrs:{title:"屏幕截图",visible:e.showScreenShot,"modal-append-to-body":!1},on:{"update:visible":function(t){e.showScreenShot=t}}},[n("img",{staticStyle:{width:"300px"},attrs:{src:e.screenShotSrc}}),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showScreenShot=!1}}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]},g=n("VU/8")(m,f,!1,null,null,null);t.default=g.exports}});