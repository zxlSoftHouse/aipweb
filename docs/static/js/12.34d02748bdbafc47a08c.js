webpackJsonp([12],{ImoN:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.app-main-home {\n  background-image: url("+n("yRcn")+");\n}\n.bg-grey-dark {\n  background: #000;\n}\n.screen-box {\n  width: calc(100% - 430px);\n}\n#playbackPlugin {\n  height: 80vh;\n}\n#playback {\n  background: #1C2130 !important;\n  padding: 10px 0;\n}\n#playback > div {\n    margin: 0 !important;\n}\n#playback .playback-ctrl {\n    height: 65px;\n    background: rgba(0, 0, 0, 0.5);\n    color: #bababa;\n    text-align: center;\n}\n#playback .playback-ctrl .iconfont {\n      font-size: 16px;\n      margin-right: 20px;\n}\n#playback .playback-ctrl .iconfont.reverse {\n        -webkit-transform: rotate(180deg);\n                transform: rotate(180deg);\n        position: relative;\n}\n#playback .playback-ctrl .iconfont.disabled {\n        color: #565656;\n        cursor: not-allowed;\n}\n#playback .playback-ctrl .iconfont.kf {\n        position: relative;\n        font-size: 22px;\n        top: 2px;\n}\n#playback .toolbar {\n    width: 430px;\n}\n#playback .toolbar .box-card {\n      margin-bottom: 30px;\n      overflow: visible;\n      border-color: rgba(18, 122, 195, 0.8);\n      background-color: rgba(5, 35, 56, 0.8);\n}\n#playback .toolbar .box-card .el-card__body {\n        position: relative;\n}\n#playback .toolbar .box-card .el-card__body .title {\n          color: #fff;\n          position: absolute;\n          top: -10px;\n          display: inline-block;\n          background: #1c2130;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse {\n          border-top: 1px solid transparent;\n          border-bottom: 1px solid transparent;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__header {\n            color: #fff;\n            background: transparent;\n            border-bottom: 1px solid transparent;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap {\n            background: transparent;\n            border-bottom: 1px solid transparent;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content {\n              color: #fff;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content .camera-item {\n                cursor: pointer;\n                padding: 10px 5px;\n                border-radius: 3px;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content .camera-item:hover, #playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content .camera-item.active {\n                  background: rgba(18, 122, 195, 0.8);\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content .camera-item .iconfont {\n                  position: relative;\n                  top: 1px;\n                  margin-right: 5px;\n                  color: #67C23A;\n}\n#playback .toolbar .box-card .el-card__body .el-collapse .el-collapse-item__wrap .el-collapse-item__content .camera-item .iconfont.icon-buzaixian {\n                    color: #F56C6C;\n}\n",""])},KH83:function(e,t,n){var i=n("ImoN");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("122d9ac6",i,!0)},xqv0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("w3JC"),a=n("JZNP"),o=n("jN+Q"),s=(n("ov/b"),{data:function(){return{tConfig:{interval:1e3},BarMove:!1,pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},type:-1,isReverse:!1,isCut:!1,isPlay:!1,ip:"",activeNames:["1"],cameraItemActive:-1,nvrOptions:[],cameraOptions:[],szDeviceIdentify:"",bZeroChannel:!1,szInfo:"",szStartTime:"",szEndTime:"",dateSel:"",online:!1,iChannelID:1,speedElem:1}},computed:{},methods:{videoInitPlugin:function(){-1!==WebVideoCtrl.I_CheckPluginInstall()?this.initPlugin():alert("您还未安装过插件，双击开发包目录里的WebComponentsKit.exe安装！")},initPlugin:function(){WebVideoCtrl.I_InitPlugin("100%","100%",{bWndFull:!0,iPackageType:2,iWndowType:1,bNoPlugin:!0,cbInitPluginComplete:function(){WebVideoCtrl.I_InsertOBJECTPlugin("playbackPlugin"),-1!==WebVideoCtrl.I_CheckPluginVersion()||alert("检测到新的插件版本，双击开发包目录里的WebComponentsKit.exe升级！")}})},loginVideoOut:function(e){if(null!=e)WebVideoCtrl.I_Logout(e)},loginCurrentMonitorOut:function(e){for(var t=0;t<e.length;t++)this.loginVideoOut(e[t].ip+"_"+e[t].port)},loginVideo:function(e,t,n,i,a){var o=this;o.cameraOptions=[],WebVideoCtrl.I_Login(e,t,n,i,a,{async:!0,success:function(t){o.szDeviceIdentify=e+"_"+n,o.getDigitalChannelInfo()},error:function(){console.log("登录失败")}})},getDigitalChannelInfo:function(){if(null!=this.szDeviceIdentify){var e=this;WebVideoCtrl.I_GetAnalogChannelInfo(this.szDeviceIdentify,{async:!0,success:function(e){$(e).find("VideoInputChannel").length},error:function(){}}),WebVideoCtrl.I_GetDigitalChannelInfo(this.szDeviceIdentify,{async:!0,success:function(t){var n=$(t).find("InputProxyChannelStatus");$.each(n,function(){var t=parseInt($(this).find("id").eq(0).text(),10),n=$(this).find("name").eq(0).text(),i=$(this).find("ipAddress").eq(0).text(),a=$(this).find("srcInputPort").eq(0).text(),o=$(this).find("managePortNo").eq(0).text(),s=$(this).find("online").eq(0).text(),l=$(this).find("proxyProtocol").eq(0).text();e.cameraOptions.push({id:t,name:n,ipAddress:i,srcInputPort:a,managePortNo:o,online:s,proxyProtocol:l})})},error:function(e,t){}})}},clickCameraItem:function(e){this.cameraItemActive=e,this.iChannelID=this.cameraOptions[e].id,this.online=this.cameraOptions[e].online,this.clickStopPlayback()},playback:function(){var e=this;if("false"!=this.online)if(-1!=this.cameraItemActive)if(""!=this.dateSel){var t=WebVideoCtrl.I_GetWindowStatus(0);null!=this.szDeviceIdentify&&(this.bZeroChannel||(null!=t?1==this.type?WebVideoCtrl.I_Stop({success:function(){e.startPlayback()}}):this.clickResume():this.startPlayback()))}else this.showWarn("您还没选择日期哦！");else this.showWarn("您的监控还没选择哦！");else this.showWarn("该摄像头不在线哦！")},startPlayback:function(){var e=this;this.szStartTime=this.dateSel+" "+this.$refs.getChild.barBeginTime,this.szEndTime=this.dateSel+" 23:59:59",console.log(this.iChannelID),WebVideoCtrl.I_StartPlayback(this.szDeviceIdentify,{iChannelID:e.iChannelID,szStartTime:e.szStartTime,szEndTime:e.szEndTime,success:function(){"00:00:00"==e.$refs.getChild.barBeginTime?setTimeout(function(){e.$refs.getChild.openBar()},1500):(e.speedElem=1,e.$refs.getChild.stopBar(),e.tConfig.interval=1e3/e.speedElem,e.$refs.getChild.openBar()),e.szInfo="开始回放成功！",e.isPlay=!0,e.isReverse=!1,e.type=0},error:function(t,n){e.szInfo=403===t?"设备不支持Websocket取流！":"开始回放失败！"}})},clickStopPlayback:function(){var e=this;null!=WebVideoCtrl.I_GetWindowStatus(0)&&WebVideoCtrl.I_Stop({success:function(){e.isPlay=e.isReverse=e.isCut=!1,e.szInfo="停止回放成功！",e.$refs.getChild.resetTime()},error:function(){e.szInfo="停止回放失败！"}})},reversePlayback:function(){var e=this;if(-1!=this.cameraItemActive)if(""!=this.dateSel){var t=WebVideoCtrl.I_GetWindowStatus(0);null!=this.szDeviceIdentify&&(this.bZeroChannel||(null!=t?0==this.type?WebVideoCtrl.I_Stop({success:function(){e.startReversePlayback()}}):this.clickResume(1):this.startReversePlayback()))}else this.showWarn("您还没选择日期哦！");else this.showWarn("您的监控还没选择哦！")},startReversePlayback:function(){0==WebVideoCtrl.I_ReversePlayback(this.szDeviceIdentify,{iChannelID:this.iChannelID,szStartTime:this.szStartTime,szEndTime:this.szEndTime})?(this.isPlay=!1,this.szInfo="开始倒放成功！",this.isReverse=!0,this.type=1):this.szInfo="开始倒放失败！"},clickPause:function(){var e=this;null!=WebVideoCtrl.I_GetWindowStatus(0)&&WebVideoCtrl.I_Pause({success:function(){e.$refs.getChild.stopBar(),e.isPlay=e.isReverse=e.isCut=!1,e.szInfo="暂停成功！"},error:function(){e.szInfo="暂停失败！"}})},clickResume:function(e){var t=this;null!=WebVideoCtrl.I_GetWindowStatus(0)&&WebVideoCtrl.I_Resume({success:function(){t.speedElem=1,1==e?t.isReverse=!0:(t.isPlay=!0,setTimeout(function(){t.$refs.getChild.openBar()},700)),t.szInfo="恢复成功！"},error:function(){t.szInfo="恢复失败！"}})},clickPlayFast:function(){var e=WebVideoCtrl.I_GetWindowStatus(0),t=this;null!=e&&this.isPlay&&WebVideoCtrl.I_PlayFast({success:function(){t.szInfo="快放成功！",t.speedElem=2*t.speedElem,t.$refs.getChild.stopBar(),t.tConfig.interval=1e3/t.speedElem,t.$refs.getChild.openBar(),console.log(e.szDeviceIdentify+" "+t.szInfo)},error:function(){t.szInfo="快放失败！",console.log(e.szDeviceIdentify+" "+t.szInfo)}})},clickPlaySlow:function(){var e=WebVideoCtrl.I_GetWindowStatus(0),t=this;null!=e&&this.isPlay&&WebVideoCtrl.I_PlaySlow({success:function(){t.szInfo="慢放成功！",t.speedElem=t.speedElem/2,t.$refs.getChild.stopBar(),t.tConfig.interval=1e3/t.speedElem,console.log(t.tConfig.interval),t.$refs.getChild.openBar(),console.log(e.szDeviceIdentify+" "+t.szInfo)},error:function(){t.szInfo="慢放失败！",console.log(e.szDeviceIdentify+" "+t.szInfo)}})},clickFrame:function(){var e=WebVideoCtrl.I_GetWindowStatus(0),t=this;null!=e&&this.isPlay&&WebVideoCtrl.I_Frame({success:function(){t.szInfo="单帧播放成功！",console.log(e.szDeviceIdentify+" "+t.szInfo)},error:function(){t.szInfo="单帧播放失败！",console.log(e.szDeviceIdentify+" "+t.szInfo)}})},clickCapturePic:function(){var e=WebVideoCtrl.I_GetWindowStatus(0);if(null!=e&&this.isPlay){var t=WebVideoCtrl.I_GetLocalCfg(),n="0";null!=t&&(n=$(t).find("CaptureFileFormat").eq(0).text());var i=e.szDeviceIdentify+"_"+this.iChannelID+"_"+(new Date).getTime();i+="0"===n?".jpg":".bmp";var a=WebVideoCtrl.I_CapturePic(i,{bDateDir:!0});this.szInfo=0==a?"抓图成功！":"抓图失败！",this.showWarn(e.szDeviceIdentify+" "+this.szInfo,1)}},clickStartRecord:function(){var e=WebVideoCtrl.I_GetWindowStatus(0);if(null!=e&&this.isPlay){var t=e.szDeviceIdentify+"_"+this.iChannelID+"_"+(new Date).getTime(),n=this;WebVideoCtrl.I_StartRecord(t,{bDateDir:!0,success:function(){n.isCut=!0,n.szInfo="开始剪辑成功！",n.showWarn(e.szDeviceIdentify+" "+n.szInfo,1)},error:function(){n.szInfo="开始剪辑失败！",n.showWarn(e.szDeviceIdentify+" "+n.szInfo)}})}},clickStopRecord:function(){var e=WebVideoCtrl.I_GetWindowStatus(0);if(null!=e){var t=this;WebVideoCtrl.I_StopRecord({success:function(){t.isCut=!1,t.szInfo="停止剪辑成功！",t.showWarn(e.szDeviceIdentify+" "+t.szInfo,1)},error:function(){t.szInfo="停止剪辑失败！",t.showWarn(e.szDeviceIdentify+" "+t.szInfo)}})}},getNVRInfo:function(){var e=this;o.a.getNVRList("1").then(function(t){e.nvrOptions=t});var t=this;setTimeout(function(){console.log(t.nvrOptions)},1e3)},handleChange:function(e){for(var t=0;t<this.nvrOptions.length;t++)if(t!=e){var n=this.nvrOptions[t].ip+"_"+this.nvrOptions[t].port;this.loginVideoOut(n)}var i=this.nvrOptions[e];if(!this.activeNames){var a=i.ip+"_"+i.port;this.loginVideoOut(a)}i&&this.loginVideo(i.ip,1,i.port,i.cameraUser,i.cameraPassword)},dateChange:function(e){this.$refs.getChild.resetTime(),this.clickStopPlayback()},typeChange:function(e){this.type=e},showWarn:function(e,t){var n="警告",i="warning";1==t&&(n="成功",i="success"),this.$notify({title:n,message:e,type:i,position:"bottom-right"})}},created:function(){this.getNVRInfo()},mounted:function(){this.videoInitPlugin()},destroyed:function(){this.loginCurrentMonitorOut(this.nvrOptions)},components:{publicHeader:i.default,timeBar:a.default}}),l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"app-main-home"},[n("publicHeader"),e._v(" "),n("div",{attrs:{id:"playback"}},[n("el-row",{attrs:{type:"flex",align:"top",gutter:22}},[n("el-col",{staticClass:"screen-box",attrs:{span:18}},[n("div",{staticClass:"bg-grey-dark",attrs:{id:"playbackPlugin"}}),e._v(" "),n("div",{staticClass:"playback-ctrl"},[n("timeBar",{ref:"getChild",attrs:{data:e.tConfig},on:{playback:e.playback,typeChange:e.typeChange}}),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"停止",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-zanting",on:{click:e.clickStopPlayback}})]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"慢放X"+e.speedElem,placement:"bottom"}},[n("a",{staticClass:"iconfont icon-zuokuaifang kf",class:{disabled:!e.isPlay},on:{click:e.clickPlaySlow}})]),e._v(" "),e.isPlay?e._e():n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"播放",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-bofang",on:{click:e.playback}})]),e._v(" "),e.isPlay?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"暂停",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-bofang1",on:{click:e.clickPause}})]):e._e(),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"快放X"+e.speedElem,placement:"bottom"}},[n("a",{staticClass:"iconfont icon-youkuaifang kf",class:{disabled:!e.isPlay},on:{click:e.clickPlayFast}})]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"抓图",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-tubiao_zhuatu- kf",class:{disabled:!e.isPlay},on:{click:e.clickCapturePic}})]),e._v(" "),e.isCut?e._e():n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"开始剪辑",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-kaishijianji kf",class:{disabled:!e.isPlay},on:{click:e.clickStartRecord}})]),e._v(" "),e.isCut?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"停止剪辑",placement:"bottom"}},[n("a",{staticClass:"iconfont icon-jieshujianji kf",on:{click:e.clickStopRecord}})]):e._e()],1)]),e._v(" "),n("el-col",{staticClass:"toolbar"},[n("el-card",{staticClass:"box-card"},[n("label",{staticClass:"title"},[e._v("日期选择")]),e._v(" "),n("el-date-picker",{attrs:{clearable:!1,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期","picker-options":e.pickerOptions},on:{change:e.dateChange},model:{value:e.dateSel,callback:function(t){e.dateSel=t},expression:"dateSel"}})],1),e._v(" "),n("el-card",{staticClass:"box-card"},[n("label",{staticClass:"title"},[e._v("监控点")]),e._v(" "),n("el-collapse",{attrs:{accordion:""},on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.nvrOptions,function(t,i){return n("el-collapse-item",{key:i,attrs:{title:t.cameraName,name:i}},e._l(e.cameraOptions,function(t,i){return n("div",{key:i,staticClass:"camera-item",class:{active:i==e.cameraItemActive},on:{click:function(t){return e.clickCameraItem(i)}}},[n("i",{staticClass:"iconfont",class:"false"==t.online?"icon-buzaixian":"icon-zaixian1"}),e._v("\n                "+e._s(t.name)+"\n              ")])}),0)}),1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var c=n("VU/8")(s,l,!1,function(e){n("KH83")},null,null);t.default=c.exports}});