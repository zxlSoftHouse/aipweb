webpackJsonp([9],{F8H7:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.dialog-common-audio .el-dialog {\n  width: 32%;\n  background: rgba(0, 0, 0, 0.7);\n  -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  border-radius: 6px;\n}\n.dialog-common-audio .el-dialog audio {\n    width: 100%;\n    outline: none;\n}\n.dialog-common-audio .el-dialog .el-dialog__header {\n    padding: 12px 20px 10px;\n}\n.dialog-common-audio .el-dialog .el-dialog__body {\n    padding: 15px 20px;\n}\n.dialog-common-audio .el-dialog .el-dialog__title {\n    color: #fff;\n    font-weight: 500;\n    font-size: 20px;\n}\n.dialog-common-audio .el-dialog .el-dialog__headerbtn .el-dialog__close {\n    font-weight: 1000;\n}\n.icon-listen {\n  cursor: pointer;\n}\n",""])},Hd6O:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("gBtx"),n=a.n(o),i=(a("vLgD"),a("lbHh")),l=a.n(i),r=a("YV7l"),s=(a("Aeww"),{data:function(){return{total:0,pageCount:10,pageIndex:0,tableData:[],multipleSelection:[],videoFlag:!1,videoUploadPercent:0,showDialog:!1,audioSrc:null,dialogTitle:null,fileData:{subpath:"",unformat:"1"}}},computed:{token:function(){return l.a.get("access_token")}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var e=this,t={pageIndex:this.pageIndex,pageCount:this.pageCount,filter:"*"};r.a.getList(t).then(function(t){e.total=parseInt(t.total),e.tableData=t.rows})},listen:function(e){this.showDialog=!0,this.audioSrc=this.GLOBAL.broadcastURL+"/MediaFiles//"+e.name,this.dialogTitle=e.name},fileSizeFormatter:function(e){return(e.fileSize/1e6).toFixed(3)+"M"},handleSelectionChange:function(e){this.multipleSelection=e},current_change:function(e){this.currentPage=e,this.getTableData()},doDelete:function(e){var t=this;r.a.delMedia(e).then(function(e){1==e.res?t.$message({type:"success",message:"删除成功"}):t.$message.error(e.errorMsg),t.getTableData()})},handleDelete:function(){var e=this;1==this.multipleSelection.length?this.$confirm("确定要删除此条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;e.multipleSelection.map(function(e){t="//"+e.name});var a={fileName:t};e.doDelete(a)}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.multipleSelection.length>1?this.$message({type:"warning",message:"只能选择一条记录"}):this.$message({type:"warning",message:"请先选择一条记录"})},beforeSrcUpload:function(e){if(!["audio/mp3"].some(function(t){return t==e.type}))return this.$message.error("文件格式错误！只能上传mp3格式的文件"),!1},uploadSuccess:function(e,t){this.videoFlag=!1,this.videoUploadPercent=0,this.$message({type:"success",message:"上传成功"}),this.getTableData()},uploadError:function(e){this.$message.error(e)},uploadVideoProcess:function(e,t,a){this.videoFlag=!0,this.videoUploadPercent=n()(t.percentage.toFixed(0))}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:3}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/audioSer/php/addmediadata.php",multiple:"",data:e.fileData,accept:"audio/mp3",headers:{access_token:e.token,Authorization:"bearer "+e.token},"show-file-list":!1,"before-upload":e.beforeSrcUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError,"on-progress":e.uploadVideoProcess}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),1==e.videoFlag?a("el-col",{attrs:{span:5}},[a("el-progress",{attrs:{type:"line",percentage:e.videoUploadPercent}})],1):e._e(),e._v(" "),a("el-col",[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除文件")])],1)],1),e._v(" "),a("el-row"),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:"文件大小"}}),e._v(" "),a("el-table-column",{attrs:{prop:"durations",label:"播放时长"}}),e._v(" "),a("el-table-column",{attrs:{label:"试听"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"icon-listen",on:{click:function(a){return e.listen(t.row)}}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.current_change}})],1),e._v(" "),a("el-dialog",{staticClass:"dialog-common-audio",attrs:{title:e.dialogTitle,visible:e.showDialog,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t}}},[a("audio",{attrs:{id:"audioSrc",controls:"",src:e.audioSrc}})])],1)},staticRenderFns:[]};var d=a("VU/8")(s,c,!1,function(e){a("ifOC")},null,null);t.default=d.exports},ifOC:function(e,t,a){var o=a("F8H7");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("51bfa316",o,!0)}});