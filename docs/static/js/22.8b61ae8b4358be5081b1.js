webpackJsonp([22],{"5dAK":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("gBtx"),o=a.n(n),r=a("vLgD"),l=a("lbHh"),i=a.n(l),c=function(e,t){return Object(r.a)({url:"api/SERVICE-AIP/ledResource/queryPage",method:"post",data:{pageNum:e,pageSize:t}})},s=function(e){return Object(r.a)({url:"api/SERVICE-AIP/ledResource/deleteResource",method:"post",data:e})},u=function(e){return Object(r.a)({url:"api/SERVICE-AIP/ledResource/public/ledResourceDownload",method:"get",params:{id:e}})},p={data:function(){return{total:0,pageSize:10,currentPage:1,tableData:[],multipleSelection:[],videoFlag:!1,videoUploadPercent:0}},computed:{token:function(){return i.a.get("access_token")}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var e=this;c(this.currentPage,this.pageSize).then(function(t){e.total=t.total,e.tableData=t.records})},fileSizeFormatter:function(e){return(e.fileSize/1e6).toFixed(3)+"M"},handleSelectionChange:function(e){this.multipleSelection=e},current_change:function(e){this.currentPage=e,this.getTableData()},handleDelete:function(){var e=this;0!=this.multipleSelection.length?this.$confirm("确定要删除此条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(e){t.push(e.rowId)}),e.doDelete(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({type:"warning",message:"请先选择一条记录"})},doDelete:function(e){var t=this;s(e).then(function(e){e.result?t.$message({type:"success",message:"删除成功"}):t.$message.error(e.errorMsg),t.getTableData()})},beforeSrcUpload:function(e){if(!["image/jpeg","image/gif","image/png","image/bmp","video/mp4"].some(function(t){return t===e.type}))return this.$message.error("文件格式错误！只能上传jpeg/gif/png/bmp/mp4格式的文件"),!1},uploadSuccess:function(e,t){this.videoFlag=!1,this.videoUploadPercent=0,this.$message({type:"success",message:"上传成功"}),this.getTableData()},uploadError:function(e){this.$message.error(e)},uploadVideoProcess:function(e,t,a){this.videoFlag=!0,this.videoUploadPercent=o()(t.percentage.toFixed(0))},preview:function(e){var t=this.GLOBAL.ftpuri+e;window.open(t,"_blank")},download:function(e){u(e).then(function(e){})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:3}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/SERVICE-AIP/ledResource/ledResourceUpload",multiple:"",accept:"image/jpeg,image/gif,image/png,image/bmp,video/mp4",headers:{access_token:e.token,Authorization:"bearer "+e.token},"show-file-list":!1,"before-upload":e.beforeSrcUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError,"on-progress":e.uploadVideoProcess}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),1==e.videoFlag?a("el-col",{attrs:{span:5}},[a("el-progress",{attrs:{type:"line",percentage:e.videoUploadPercent}})],1):e._e(),e._v(" "),a("el-col",[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除文件")])],1)],1),e._v(" "),a("el-row"),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"resourceName",label:"资源名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fileSize",label:"资源大小",formatter:e.fileSizeFormatter}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"预览",placement:"top"}},[a("el-button",{attrs:{icon:"el-icon-search",circle:""},on:{click:function(a){return e.preview(t.row.filePath)}}})],1)]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.current_change}})],1)],1)},staticRenderFns:[]},g=a("VU/8")(p,d,!1,null,null,null);t.default=g.exports}});