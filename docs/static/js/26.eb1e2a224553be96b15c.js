webpackJsonp([26],{"lBa/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("woOf"),l=a.n(o),r=a("vLgD"),n=function(e,t){return Object(r.a)({url:"api/SERVICE-AIP/road/queryPage",method:"post",data:{pageNum:e,pageSize:t}})},i=function(e){return Object(r.a)({url:"api/SERVICE-AIP/road/deleteByIdList",method:"post",data:e})},s=function(e){return Object(r.a)({url:"api/SERVICE-AIP/road/update",method:"put",data:e})},c=function(){return Object(r.a)({url:"api/SERVICE-AIP/project/queryList",method:"post",data:{}})},d={data:function(){return{flag:"",total:0,pageSize:10,currentPage:1,tableData:[],multipleSelection:[],showDialog:!1,dialogTitle:"",road:{rowId:"",projectId:"",roadName:"",remark:""},rules:{roadName:[{required:!0,message:"请输入路段名称",trigger:"blur"}],projectId:[{required:!0,message:"请选择所属项目",trigger:"change"}]},projectOptions:[],formLabelWidth:"80px"}},components:{},mounted:function(){this.getTableData(),this.getProjectOptions()},methods:{getTableData:function(){var e=this;n(this.currentPage,this.pageSize).then(function(t){e.total=t.total,e.tableData=t.records})},getProjectOptions:function(){var e=this;c().then(function(t){e.projectOptions=t})},handleAdd:function(){this.road.rowId="",this.flag="add",this.dialogTitle="新增",this.showDialog=!0},handleEdit:function(){if(this.flag="edit",0!=this.multipleSelection.length)if(1===this.multipleSelection.length){var e=this.multipleSelection[0];this.road=l()(this.road,e),this.dialogTitle="编辑",this.showDialog=!0}else this.$message({type:"warning",message:"不支持多条编辑"});else this.$message({type:"warning",message:"请先选择一条记录"})},handleDelete:function(){var e=this;0!=this.multipleSelection.length?this.$confirm("确定要删除此条记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(e){t.push(e.rowId)}),e.doDelete(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({type:"warning",message:"请先选择一条记录"})},doDelete:function(e){var t=this;i(e).then(function(e){e?(t.$message({type:"success",message:"删除成功"}),t.getTableData()):t.$message.error("服务器错误")})},saveOrUpdate:function(){var e=this;this.$refs.Form.validate(function(t){t&&s(e.road).then(function(t){t.rowId?(e.showDialog=!1,e.$message({type:"success",message:"add"==e.flag?"新增成功":"修改成功"}),e.getTableData()):e.$message.error("服务器错误")})})},cancelUpdate:function(){this.showDialog=!1,this.$refs.Form.resetFields()},handleSelectionChange:function(e){this.multipleSelection=e},current_change:function(e){this.currentPage=e,this.getTableData()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleAdd()}}},[e._v("新增")]),e._v(" "),a("el-button",{on:{click:function(t){return e.handleEdit()}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadName",label:"路段名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectName",label:"归属项目"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.current_change}})],1),e._v(" "),a("el-dialog",{staticClass:"dialog-common-sys",attrs:{title:e.dialogTitle,visible:e.showDialog,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.cancelUpdate()}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"Form",attrs:{model:e.road,rules:e.rules}},[a("el-form-item",{attrs:{label:"路段名称","label-width":e.formLabelWidth,prop:"roadName"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写路段名称"},model:{value:e.road.roadName,callback:function(t){e.$set(e.road,"roadName",t)},expression:"road.roadName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属项目","label-width":e.formLabelWidth,prop:"projectId"}},[a("el-select",{attrs:{placeholder:"请选择所属项目"},model:{value:e.road.projectId,callback:function(t){e.$set(e.road,"projectId",t)},expression:"road.projectId"}},e._l(e.projectOptions,function(e){return a("el-option",{key:e.rowId,attrs:{label:e.projectName,value:e.rowId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth,prop:"remark"}},[a("el-input",{attrs:{autosize:"",type:"textarea",maxlength:"128",placeholder:"请填写备注",resize:"none"},model:{value:e.road.remark,callback:function(t){e.$set(e.road,"remark",t)},expression:"road.remark"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancelUpdate()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveOrUpdate()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]},p=a("VU/8")(d,u,!1,null,null,null);t.default=p.exports}});