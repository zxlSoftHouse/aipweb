webpackJsonp([8],{"83EP":function(t,n,o){var i=o("DFlG");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o("rjj0")("5fa67fdd",i,!0)},DFlG:function(t,n,o){(t.exports=o("FZ+f")(!1)).push([t.i,"\n.app-main-home {\n  background-image: url("+o("yRcn")+");\n}\n.bg-grey-dark {\n  background: #000;\n}\n.grid-content {\n  border-radius: 4px;\n  min-height: 36px;\n}\n.screen-box {\n  width: calc(100% - 430px);\n}\n#divPlugin {\n  height: 90vh;\n}\n#monitor {\n  background: #1C2130 !important;\n  padding: 10px 0;\n}\n#monitor > div {\n    margin: 0 !important;\n}\n#monitor .el-dialog__wrapper {\n    left: calc(100% - 420px);\n}\n#monitor .el-dialog__wrapper .el-dialog {\n      margin-top: 0 !important;\n      height: 100%;\n      width: 100%;\n}\n#monitor .toolbar {\n    width: 430px;\n}\n#monitor .toolbar .box-card {\n      margin-bottom: 30px;\n      overflow: visible;\n      border-color: rgba(18, 122, 195, 0.8);\n      background-color: rgba(5, 35, 56, 0.8);\n}\n#monitor .toolbar .box-card .el-card__body {\n        position: relative;\n}\n#monitor .toolbar .box-card .el-card__body .title {\n          color: #fff;\n          position: absolute;\n          top: -10px;\n          display: inline-block;\n          background: #1c2130;\n}\n#monitor .toolbar .box-card .el-card__body .el-select {\n          display: block;\n}\n#monitor .toolbar .box-card .el-card__body .monitor-list {\n          height: calc(45vh - 24px);\n          overflow: auto;\n}\n#monitor .toolbar .box-card .el-card__body .monitor-list li {\n            color: #fff;\n            padding: 5px;\n            cursor: pointer;\n}\n#monitor .toolbar .box-card .el-card__body .monitor-list li:hover, #monitor .toolbar .box-card .el-card__body .monitor-list li.active {\n              background: rgba(18, 122, 195, 0.3);\n}\n#monitor .toolbar .yt .el-form-item__label {\n      color: #fff;\n}\n#monitor .toolbar .yt .yt-btn {\n      padding: 7px;\n      margin-bottom: 10px;\n}\n#monitor .toolbar .yt .yt-btn.yt-lt i, #monitor .toolbar .yt .yt-btn.yt-rt i, #monitor .toolbar .yt .yt-btn.yt-lb i, #monitor .toolbar .yt .yt-btn.yt-rb i {\n        -webkit-transform: rotate(-45deg);\n                transform: rotate(-45deg);\n}\n",""])},NhWH:function(t,n,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0});o("Aeww");var i=o("w3JC"),e=o("M39K"),r=o("jN+Q"),a=o("ov/b"),l={data:function(){return{g_bPTZAuto:!1,iPTZSpeed:4,screenOption:[{value:1,label:"1 × 1"},{value:2,label:"2 × 2"},{value:3,label:"3 × 3"}],iWndowType:2,ytSpeed:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7}],ytForm:{name:1},sel_monitorOptions:[],monitorOptions:[],dialogObj:{isShow:!1,g_iWndIndex:0,cameraIdArr:[],cameraNum:"",monitorId:"",monitorName:"",monitorNo:"",nvr:""},dif_devOptions:[],iChannelOptions:[],activeNum:0}},methods:{videoInitPlugin:function(){-1!==WebVideoCtrl.I_CheckPluginInstall()?this.initPlugin():alert("您还未安装过插件，双击开发包目录里的WebComponentsKit.exe安装！")},initPlugin:function(){var t=this;WebVideoCtrl.I_InitPlugin("100%","100%",{iPackageType:2,iWndowType:t.iWndowType,bNoPlugin:!0,cbSelWnd:function(n){t.dialogObj.g_iWndIndex=parseInt($(n).find("SelectWnd").eq(0).text(),10)},cbInitPluginComplete:function(){WebVideoCtrl.I_InsertOBJECTPlugin("divPlugin"),-1!==WebVideoCtrl.I_CheckPluginVersion()||alert("检测到新的插件版本，双击开发包目录里的WebComponentsKit.exe升级！")}})},loginVideo:function(t,n,o,i,e,r){var a=this,l=t+"_"+n;WebVideoCtrl.I_Login(t,1,n,o,i,{async:!0,success:function(o){a.iChannelOptions=[],console.log(l+"登录成功"),a.dif_devOptions.push({szIP:t,szPort:n}),r?setTimeout(function(){a.startRealPlay(l,e,r)},100):a.getDigitalChannelInfo(l)},error:function(){a.iChannelOptions=[],a.showWarn(l+"登录失败")}})},getDigitalChannelInfo:function(t){var n=this;t&&WebVideoCtrl.I_GetDigitalChannelInfo(t,{async:!0,success:function(t){n.iChannelOptions=[];var o=$(t).find("InputProxyChannelStatus");$.each(o,function(){var t=parseInt($(this).find("id").eq(0).text(),10),o=$(this).find("name").eq(0).text(),i=$(this).find("ipAddress").eq(0).text(),e=$(this).find("srcInputPort").eq(0).text(),r=$(this).find("managePortNo").eq(0).text(),a=$(this).find("online").eq(0).text(),l=$(this).find("proxyProtocol").eq(0).text();n.iChannelOptions.push({id:t,name:o,ipAddress:i,srcInputPort:e,managePortNo:r,online:a,proxyProtocol:l})})},error:function(t,o){n.iChannelOptions=[]}})},loginVideoOut:function(t){if(null!=t)WebVideoCtrl.I_Logout(t)},loginCurrentMonitorOut:function(t){for(var n=0;n<t.length;n++)this.loginVideoOut(t[n].szIP+"_"+t[n].szPort)},stopRealPlay:function(t){null!=WebVideoCtrl.I_GetWindowStatus(t)&&WebVideoCtrl.I_Stop({iWndIndex:t,success:function(){},error:function(){}})},stopCurrentRealPlay:function(t){for(var n=0;n<t;n++)this.stopRealPlay(n)},startRealPlay:function(t,n,o){WebVideoCtrl.I_StartRealPlay(t,{iWndIndex:n,iChannelID:o,success:function(){},error:function(t,n){}})},changeWndNum:function(t){t=parseInt(t,10),WebVideoCtrl.I_ChangeWndNum(t);var n=Math.pow(this.iWndowType,2),o=this.dialogObj.cameraIdArr.length;o<n&&this.inScreen(n,o),o>n&&this.deScreen(n,o)},clickFullScreen:function(){WebVideoCtrl.I_FullScreen(!0)},mouseDownPTZControl:function(t){if(null!=WebVideoCtrl.I_GetWindowStatus(this.dialogObj.g_iWndIndex)){9==t&&this.g_bPTZAuto||(this.g_bPTZAuto=!1);var n=this;WebVideoCtrl.I_PTZControl(t,!1,{iPTZSpeed:n.iPTZSpeed,success:function(o){9==t&&n.g_bPTZAuto&&n.PTZControl(t,!0,"云台停止"),9==t&&(n.g_bPTZAuto=!n.g_bPTZAuto)},error:function(t,n){}})}},PTZControl:function(t,n,o){if(null!=WebVideoCtrl.I_GetWindowStatus(this.dialogObj.g_iWndIndex)){WebVideoCtrl.I_PTZControl(t,n,{iWndIndex:this.dialogObj.g_iWndIndex,iPTZSpeed:this.iPTZSpeed,success:function(t){},error:function(t,n){}})}},bindCamera:function(){this.dialogObj.isShow=!0,this.getMonitorItem(this.monitorOptions[this.activeNum]),this.dialogObj.cameraNum=this.iWndowType},inScreen:function(t,n){var o="";"0"==this.dialogObj.nvr&&(o=1);for(var i=0;i<t-n;i++)this.dialogObj.cameraIdArr.push({id:"",iChannelID:o})},deScreen:function(t,n){this.loginCurrentMonitorOut(this.dif_devOptions),this.stopCurrentRealPlay(n),this.dialogObj.cameraIdArr=[];var o="";"0"==this.dialogObj.nvr&&(o=1);for(var i=0;i<t;i++)this.dialogObj.cameraIdArr.push({id:"",iChannelID:o})},handleAddMonitor:function(){this.dialogObj.isShow=!0,this.dialogObj.cameraNum=this.iWndowType,this.dialogObj.monitorId="",this.dialogObj.monitorName="",this.dialogObj.monitorNo="",this.dialogObj.nvr="",this.dialogObj.cameraIdArr=[];var t=Math.pow(this.iWndowType,2),n="";"0"==this.dialogObj.nvr&&(n=1);for(var o=0;o<t;o++)this.dialogObj.cameraIdArr.push({id:"",iChannelID:n})},doDelete:function(t){var n=this;a.a.doDelete(t).then(function(t){t?(n.$message({type:"success",message:"删除成功"}),n.getMonitorInfo()):n.$message.error("服务器错误")})},handleDeleteMonitor:function(){if(this.sel_monitorOptions=[this.dialogObj.monitorId],0!=this.sel_monitorOptions.length){var t=[];this.sel_monitorOptions.map(function(n){t.push(n)}),this.doDelete(t)}else this.$message({type:"warning",message:"请先选择一条记录"})},getMonitorInfo:function(){var t=this;a.a.getList("","","").then(function(n){t.monitorOptions=n.data.data.records})},monitorSel:function(t,n){if(this.loginCurrentMonitorOut(this.dif_devOptions),this.dif_devOptions=[],this.dialogObj.cameraIdArr=[],this.getMonitorItem(t),this.activeNum=n,t.rowId){if(t.cameraIds){var o=t.cameraIds.split(",");for(n=0;n<o.length;n++){var i=o[n].split("_");this.dialogObj.cameraIdArr.push({id:i[0],iChannelID:i[1]})}}this.iWndowType!=t.cameraNum&&(this.iWndowType=t.cameraNum,this.changeWndNum(t.cameraNum)),this.initCameraItemGroup(this.dialogObj.cameraIdArr)}},getMonitorItem:function(t){this.dialogObj.monitorName=t.monitorName,this.dialogObj.monitorId=t.rowId,this.dialogObj.monitorNo=t.monitorNo,this.dialogObj.nvr=t.nvr},initCameraItemGroup:function(t){this.dialogObj.g_iWndIndex=0,this.getCameraItemGroup(t)},getCameraItemGroup:function(t){for(var n=0;n<t.length;n++)t[n].id?this.getCameraItem(t[n],n):this.stopRealPlay(n)},getCameraItem:function(t,n){var o=this;r.a.getItem(t.id).then(function(i){var e=i.data.data,r=e.ip,a=e.port,l=e.cameraUser,s=e.cameraPassword;if(r)if(0==o.dif_devOptions.length)o.loginVideo(r,a,l,s,n,t.iChannelID);else for(var c=r+"_"+a,u=0;u<o.dif_devOptions.length;u++){c!=o.dif_devOptions[u].szIP+"_"+o.dif_devOptions[u].szPort?o.loginVideo(r,a,l,s,n,t.iChannelID):o.startRealPlay(c,n,t.iChannelID)}})},showWarn:function(t,n){var o="警告",i="warning";1==n&&(o="成功",i="success"),this.$notify({title:o,message:t,type:i,position:"bottom-right"})}},created:function(){this.getMonitorInfo()},mounted:function(){var t=this;this.videoInitPlugin(),setTimeout(function(){t.monitorOptions.length>0&&t.monitorSel(t.monitorOptions[0],0)},500)},destroyed:function(){this.stopCurrentRealPlay(this.dialogObj.cameraIdArr.length),this.loginCurrentMonitorOut(this.dif_devOptions)},components:{publicHeader:i.default,videoDialog:e.default}},s={render:function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("section",{staticClass:"app-main-home"},[o("publicHeader"),t._v(" "),o("div",{attrs:{id:"monitor"}},[o("el-row",{attrs:{type:"flex",align:"top",gutter:22}},[o("el-col",{staticClass:"screen-box",attrs:{span:18}},[o("div",{staticClass:"bg-grey-dark",attrs:{id:"divPlugin"}}),t._v(" "),o("videoDialog",{ref:"getChild",attrs:{dialogObj:t.dialogObj,dif_devOptions:t.dif_devOptions,iChannelOptions:t.iChannelOptions},on:{handleClose:function(n){t.dialogObj.isShow=!1},loginVideo:t.loginVideo,getDigitalChannelInfo:t.getDigitalChannelInfo,monitorSel:function(n){return t.monitorSel(t.monitorOptions[t.activeNum],t.activeNum)},getMonitorInfo:t.getMonitorInfo}})],1),t._v(" "),o("el-col",{staticClass:"toolbar",attrs:{span:6}},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.clickFullScreen}},[t._v("全屏")])],1),t._v(" "),o("el-card",{staticClass:"box-card"},[o("label",{staticClass:"title"},[t._v("分屏")]),t._v(" "),o("el-select",{on:{change:function(n){return t.changeWndNum(t.iWndowType)}},model:{value:t.iWndowType,callback:function(n){t.iWndowType=n},expression:"iWndowType"}},t._l(t.screenOption,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("el-card",{staticClass:"box-card yt"},[o("label",{staticClass:"title"},[t._v("云台控制")]),t._v(" "),o("el-row",{attrs:{type:"flex"}},[o("el-col",[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini"},on:{click:t.bindCamera}},[t._v("绑定摄像头")])],1)],1),t._v(" "),o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{staticClass:"yt-direction rel",attrs:{span:8}},[o("div",[o("el-button",{staticClass:"yt-btn yt-lt",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-top"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(5)},mouseup:function(n){return t.PTZControl(5,!0,"云台停止")}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-t",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-top"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(1)},mouseup:function(n){return t.PTZControl(1,!0,"云台停止")}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-rt",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-right"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(7)},mouseup:function(n){return t.PTZControl(7,!0,"云台停止")}}})],1),t._v(" "),o("div",[o("el-button",{staticClass:"yt-btn yt-l",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-left"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(3)},mouseup:function(n){return t.PTZControl(3,!0,"云台停止")}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-refresh",attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},on:{click:function(n){return t.mouseDownPTZControl(9)}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-r",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-right"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(4)},mouseup:function(n){return t.PTZControl(4,!0,"云台停止")}}})],1),t._v(" "),o("div",[o("el-button",{staticClass:"yt-btn yt-lb",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-left"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(6)},mouseup:function(n){return t.PTZControl(6,!0,"云台停止")}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-b",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-bottom"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(2)},mouseup:function(n){return t.PTZControl(2,!0,"云台停止")}}}),t._v(" "),o("el-button",{staticClass:"yt-btn yt-rb",attrs:{type:"primary",size:"mini",icon:"el-icon-caret-bottom"},nativeOn:{mousedown:function(n){return t.mouseDownPTZControl(8)},mouseup:function(n){return t.PTZControl(8,!0,"云台停止")}}})],1)]),t._v(" "),o("el-col",{attrs:{span:10}},[o("el-form",{ref:"ytForm",attrs:{model:t.ytForm,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"云台速度"}},[o("el-select",{model:{value:t.iPTZSpeed,callback:function(n){t.iPTZSpeed=n},expression:"iPTZSpeed"}},t._l(t.ytSpeed,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1),t._v(" "),o("el-col",{staticClass:"yt-scale",attrs:{span:6}},[o("div",[o("el-tooltip",{attrs:{effect:"dark",content:"变倍",placement:"top"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},nativeOn:{mousedown:function(n){return t.PTZControl(10,!1,"调焦")},mouseup:function(n){return t.PTZControl(10,!0,"调焦停止")}}})],1),t._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:"变倍",placement:"top"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-minus"},nativeOn:{mousedown:function(n){return t.PTZControl(11,!1,"调焦")},mouseup:function(n){return t.PTZControl(11,!0,"调焦")}}})],1)],1),t._v(" "),o("div",[o("el-tooltip",{attrs:{effect:"dark",content:"变焦",placement:"left"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},nativeOn:{mousedown:function(n){return t.PTZControl(12,!1,"聚焦")},mouseup:function(n){return t.PTZControl(12,!0,"聚焦停止")}}})],1),t._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:"变焦",placement:"right"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-minus"},nativeOn:{mousedown:function(n){return t.PTZControl(13,!1,"聚焦")},mouseup:function(n){return t.PTZControl(12,!0,"聚焦停止")}}})],1)],1),t._v(" "),o("div",[o("el-tooltip",{attrs:{effect:"dark",content:"光圈",placement:"bottom"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},nativeOn:{mousedown:function(n){return t.PTZControl(14,!1,"光圈")},mouseup:function(n){return t.PTZControl(14,!0,"光圈停止")}}})],1),t._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:"光圈",placement:"bottom"}},[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-minus"},nativeOn:{mousedown:function(n){return t.PTZControl(15,!1,"光圈")},mouseup:function(n){return t.PTZControl(15,!0,"光圈停止")}}})],1)],1)])],1)],1),t._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{height:"45vh"}},[o("label",{staticClass:"title"},[t._v("监控点")]),t._v(" "),o("div",[o("el-button",{staticClass:"yt-btn",attrs:{type:"primary",size:"mini"},on:{click:t.handleAddMonitor}},[t._v("新增监控点")]),t._v(" "),o("el-button",{staticClass:"yt-btn",attrs:{type:"danger",size:"mini"},on:{click:t.handleDeleteMonitor}},[t._v("删除监控点")])],1),t._v(" "),o("ul",{staticClass:"monitor-list"},t._l(t.monitorOptions,function(n,i){return o("li",{key:i,class:{active:i==t.activeNum},on:{click:function(o){return t.monitorSel(n,i)}}},[t._v(t._s(n.monitorName))])}),0)])],1)],1)],1)],1)},staticRenderFns:[]};var c=o("VU/8")(l,s,!1,function(t){o("83EP")},null,null);n.default=c.exports}});