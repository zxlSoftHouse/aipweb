webpackJsonp([39],{HkrV:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"\n.app-main {\n  background: #fff;\n}\n",""])},goDZ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("0xDb"),s=o("hbRw"),a=o("vLgD"),l=function(e){return Object(a.a)({url:"/api/SERVICE-AUTH/resource/queryPage",method:"post",data:e})},i=function(e){return Object(a.a)({url:"/api/SERVICE-AUTH/resource/update",method:"put",data:e})},n=function(e){return Object(a.a)({url:"/api/SERVICE-AUTH/resource/delete/"+e,method:"delete"})},u=function(e){return Object(a.a)({url:"/api/SERVICE-AUTH/role/resource/queryList",method:"post",data:{resourceId:e}})},c=function(e){return Object(a.a)({url:"/api/SERVICE-AUTH//role/resource/saveByResourceId/"+e.resourceId,method:"post",data:e.roleIds})},d=o("buQg"),p={components:{SelectTree:o("onxG").a},data:function(){return{resourceId:"",searchInput:"",roleCode:"",tableList:[],total:0,pageSize:10,pageNum:1,isHasPage:!1,resource:{resourceType:"",resourceName:"",resourceCode:""},rules:{resourceType:[{required:!0,message:"请输入资源类型",trigger:"blur"},{min:1,max:1,message:"长度在 1 个字符",trigger:"blur"}],resourceName:[{required:!0,message:"请输入资源名称",trigger:"blur"},{min:1,max:8,message:"长度在 3 到 5 个字符",trigger:"blur"}],resourceCode:[{required:!0,message:"请输入资源编码",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}]},userId:0,menuId:-1,roleIds:[],showSetDialog:!1,roleData:[],menuData:[],menuProps:{parent:"parentId",value:"rowId",label:"menuName",children:"childs"},parentName:"",dialogTitle:"新增",showDialog:!1,tipDialog:!1,tipDialogTxt:"",showTreeDialog:!1,role:{roleCode:"",roleName:"",rowId:""},formLabelWidth:"80px",treeCount:0,treeData:[],roleId:0,filterMethod:function(e,t){return t.userName.indexOf(e)>-1}}},filters:{formatDate:function(e){var t=new Date(e);return Object(r.parseTime)(t,"{y}-{m}-{d}")}},methods:{getAllMenu:function(){var e=this;d.a.getMenuAll().then(function(t){e.menuData=t})},getAllSelect:function(){var e=this;s.a.queryList({}).then(function(t){e.roleData=t},function(e){},!1)},getList:function(){var e=this,t={pageNum:this.pageNum,pageSize:this.pageSize};l(t).then(function(t){t.records.length>0?(e.isHasPage=!0,e.tableList=t.records,e.total=t.total,e.pageSize=t.size):e.isHasPage=!1}).catch(function(t){console.log(t),e.isHasPage=!1})},doQuery:function(){this.pageNum=1,this.getList()},resetForm:function(e){this.$refs[e].resetFields()},doAdd:function(){this.showDialog=!0,this.dialogTitle="新增",this.resource={resourceName:"",resourceCode:"",resourceType:""}},delResourceRow:function(e){var t=this;this.$confirm("确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getList()},function(e){t.$message.error("网络异常，无法执行该操作!")},!1)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},doModify:function(e){this.dialogTitle="修改",this.showDialog=!0,this.resource.rowId=e.rowId,this.resource.resourceName=e.resourceName,this.resource.resourceCode=e.resourceCode,this.resource.resourceType=e.resourceType},saveAddOrUpdate:function(e,t){var o=this;this.$refs[t].validate(function(e){if(!e)return!1;o.showDialog=!1,i(o.resource).then(function(e){o.$message({type:"success",message:"新增"==o.dialogTitle?"新增成功!":"修改成功!"}),o.getList(),o.$refs[t].resetFields()},function(e){o.$message.error("网络异常，无法执行该操作!")},!1)})},cannelSet:function(){this.showSetDialog=!1},doShareRole:function(e){this.showSetDialog=!0,this.resourceId=e.rowId,this.getHasSelect(e.rowId)},getHasSelect:function(e){var t=this;u(e).then(function(e){t.roleIds=[],e.map(function(e){t.roleIds.push(e.roleId)}),t.getAllSelect()},function(e){},!1)},postSet:function(){var e=this;this.showSetDialog=!1;var t={resourceId:this.resourceId,roleIds:this.roleIds};c(t).then(function(t){e.$message({type:"success",message:"分配权限成功!"})},function(t){e.$message.error("网络异常，无法执行该操作!")},!1)},cannelChange:function(){this.showDialog=!1,this.getList()},pagePost:function(e){this.pageNum=e,this.getList()}},mounted:function(){this.getList(),this.getAllMenu()}},f={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"app-container"},[o("el-col",{staticClass:"container"},[o("div",{staticClass:"heading"},[o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.doAdd}},[e._v("新增")])],1),e._v(" "),o("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableList,border:"","tooltip-effect":"dark","highlight-current-row":""}},[o("el-table-column",{attrs:{property:"menuName",label:"关联菜单","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{property:"resourceType",label:"资源类型","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{property:"resourceName",label:"资源名称","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{property:"resourceCode",label:"资源编码","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{property:"createTime",label:"创建时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("formatDate")(t.row.createTime))+"\n                    ")]}}])}),e._v(" "),o("el-table-column",{attrs:{property:"updateTime",label:"更新时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("formatDate")(t.row.updateTime))+"\n                    ")]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.delResourceRow(t.row.rowId)}}},[e._v("删除")]),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.doModify(t.row)}}},[e._v("修改")]),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.doShareRole(t.row)}}},[e._v("权限设置")])]}}])})],1),e._v(" "),e.isHasPage?o("div",{staticClass:"pagination-wrapper block"},[o("el-pagination",{attrs:{"current-page":e.pageNum,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.pagePost}})],1):e._e(),e._v(" "),o("el-dialog",{attrs:{width:"30%","modal-append-to-body":!1,title:e.dialogTitle,visible:e.showDialog,"before-close":e.cannelChange},on:{"update:visible":function(t){e.showDialog=t}}},[o("el-form",{ref:"ruleForm",attrs:{model:e.resource,rules:e.rules}},[o("el-form-item",{attrs:{label:"资源类型","label-width":e.formLabelWidth,prop:"resourceType"}},[o("el-input",{model:{value:e.resource.resourceType,callback:function(t){e.$set(e.resource,"resourceType",t)},expression:"resource.resourceType"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"资源名称","label-width":e.formLabelWidth,prop:"resourceName"}},[o("el-input",{model:{value:e.resource.resourceName,callback:function(t){e.$set(e.resource,"resourceName",t)},expression:"resource.resourceName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"资源编码","label-width":e.formLabelWidth,prop:"resourceCode"}},[o("el-input",{model:{value:e.resource.resourceCode,callback:function(t){e.$set(e.resource,"resourceCode",t)},expression:"resource.resourceCode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属菜单","label-width":e.formLabelWidth,prop:"menuId"}},[o("select-tree",{attrs:{options:e.menuData,props:e.menuProps},model:{value:e.resource.menuId,callback:function(t){e.$set(e.resource,"menuId",t)},expression:"resource.menuId"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cannelChange}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveAddOrUpdate(e.resource,"ruleForm")}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"moreSel-dialog",attrs:{width:"40%","modal-append-to-body":!1,title:"权限设置",visible:e.showSetDialog},on:{"update:visible":function(t){e.showSetDialog=t}}},[o("el-select",{attrs:{placeholder:"请选择要给该人员分配的权限角色",multiple:""},model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},e._l(e.roleData,function(e){return o("el-option",{key:e.rowId,attrs:{label:e.roleName,value:e.rowId}})}),1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cannelSet}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.postSet}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"tipDialog",attrs:{"modal-append-to-body":!1,title:"提示",visible:e.tipDialog,size:"tiny"},on:{"update:visible":function(t){e.tipDialog=t}}},[o("span",{staticClass:"el-icon-circle-check"}),e._v(" "),o("span",{staticClass:"tipDialogTxt"},[e._v(e._s(e.tipDialogTxt))]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.tipDialog=!1}}},[e._v("确 定")])],1)])],1)],1)},staticRenderFns:[]};var m=o("VU/8")(p,f,!1,function(e){o("zZVP")},null,null);t.default=m.exports},zZVP:function(e,t,o){var r=o("HkrV");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("rjj0")("79a6bc5c",r,!0)}});